### element-ui Upload ä¸Šä¼ æ–‡ä»¶

éœ€æ±‚æè¿°ï¼šå¦‚å›¾æ‰€ç¤ºï¼Œupload åªæ˜¯ç”¨æ¥é€‰æ‹©æ–‡ä»¶ï¼Œåœ¨ç‚¹å‡»æäº¤çš„æ—¶å€™å†å’Œå…¶ä»–çš„æ•°æ®ç»Ÿä¸€ä¸Šä¼ ï¼Œå¹¶ä¸”è¦é™åˆ¶è¯¥æ–‡ä»¶åªèƒ½ä¸Šä¼ ä¸€ä¸ªï¼Œä¸ºç”¨æˆ·æœ€åé€‰æ‹©çš„é‚£ä¸ªæ–‡ä»¶ã€‚

![upload.png](https://img-blog.csdnimg.cn/20200517210121732.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNjg5NDc0NQ==,size_16,color_FFFFFF,t_70#pic_center)

-   ä¸ä½¿ç”¨ action å±æ€§ ä¸Šä¼ 
    [å®˜æ–¹æ–‡æ¡£](https://element.eleme.cn/#/zh-CN/component/upload)
    æ–‡æ¡£ä¸­æè¿°åˆ°ï¼š
    actionï¼šæ˜¯å¿…é€‰å‚æ•°ï¼Œä¸Šä¼ çš„åœ°å€ï¼›
    http-request: è¦†ç›–é»˜è®¤çš„ä¸Šä¼ è¡Œä¸ºï¼Œå¯ä»¥è‡ªå®šä¹‰ä¸Šä¼ çš„å®ç°ï¼Œ ä½¿ç”¨è¯¥å±æ€§çš„æ—¶å€™è®¾ç½®**action çš„å±æ€§å€¼ä¸º#**

-   åªèƒ½ä¸Šä¼ å•ä¸ªæ–‡ä»¶ï¼Œå¹¶èƒ½è¦†ç›–ä¸Šä¼ 
    å®˜ç½‘ API é‡Œæœ‰ä¸€ä¸ªå±æ€§ï¼Œlimitï¼ˆnumber ç±»å‹ï¼‰ï¼ŒæŒ‡çš„æ˜¯æœ€å¤§å…è®¸ä¸Šä¼ ä¸ªæ•°ï¼Œæˆ‘æ·»åŠ å…¶å±æ€§å€¼ä¸º 1ï¼Œï¼ˆ:limit='1'ï¼‰,ä½†æ˜¯è¿™æ ·ï¼Œæ— è®ºæ€æ ·é€‰æ‹©ï¼Œé¡µé¢ä¸Šå±•ç¤ºçš„å§‹ç»ˆæ˜¯ç”¨æˆ·ç¬¬ä¸€æ¬¡é€‰æ‹©çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ•ˆæœ...emmm å’Œæˆ‘ä»¬æƒ³è¦çš„ä¸ä¸€æ ·å‘¢
    ç»§ç»­çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œæœ‰ä¸ª file-list å±æ€§ï¼ŒæŒ‡çš„æ˜¯ä¸Šä¼ æ–‡ä»¶çš„åˆ—è¡¨ï¼ŒğŸ‰‘ ï¸ é€šè¿‡æ–‡ä»¶çŠ¶æ€æ”¹å˜æ—¶çš„é’©å­ on-change æ–¹æ³•ï¼Œæ”¹å˜ file-list çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸€ç›´ä¿ç•™æœ€åä¸€é¡¹ã€‚
    ![file-list.png](https://img-blog.csdnimg.cn/20200517210141373.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zNjg5NDc0NQ==,size_16,color_FFFFFF,t_70#pic_center)

æ¨¡æ¿ä»£ç 

```html
<el-upload
    class="upload-demo"
    drag
    action="#"
    :multiple="false"
    :show-file-list="true"
    :http-request="uploadHttpRequest"
    :file-list="fileList"
    :on-change="handleUploadChange"
    :before-upload="beforeUpload"
>
    <i class="el-icon-upload"></i>
    <div class="el-upload__text">å°†æ–‡ä»¶æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–<em>ç‚¹å‡»ä¸Šä¼ </em></div>
</el-upload>
```

js ä»£ç 

```js
// ä¸Šä¼ æ–‡ä»¶ä¹‹å‰çš„é’©å­ï¼Œå‚æ•°ä¸ºä¸Šä¼ çš„æ–‡ä»¶ï¼Œè‹¥è¿”å› false æˆ–è€…è¿”å› Promise ä¸”è¢« rejectï¼Œåˆ™åœæ­¢ä¸Šä¼ ã€‚
   data() {
       return {
           // ä¸Šä¼ æ–‡ä»¶çš„åˆ—è¡¨
           fileList: [],
       }
   },
   methods: {
       beforeUpload(file) {
        const fileType = file.name.substring(file.name.lastIndexOf('.'))
        if (fileType.toLowerCase() != '.txt' && fileType.toLowerCase() != '.xml') {
            this.$message.error('æ–‡ä»¶å¿…é¡»ä¸º.txtæˆ–.xmlç±»å‹')
            this.fileList = []
            return false
        }
        },
        // è¦†ç›–elementçš„é»˜è®¤ä¸Šä¼ æ–‡ä»¶
        uploadHttpRequest(data) {
            let reader = new FileReader()
            let that = this
            reader.readAsText(data.file)
            reader.onload = function() {
                that.formData.mmiapXml = this.result
            }
        },
        // é™åˆ¶æ–‡ä»¶ä¸Šä¼ çš„ä¸ªæ•°åªæœ‰ä¸€ä¸ªï¼Œè·å–ä¸Šä¼ åˆ—è¡¨çš„æœ€åä¸€ä¸ª
        handleUploadChange(file, fileList) {
            if (fileList.length > 0) {
                this.fileList = [fileList[fileList.length - 1]] // è¿™ä¸€æ­¥ï¼Œæ˜¯ å±•ç¤ºæœ€åä¸€æ¬¡é€‰æ‹©çš„æ–‡ä»¶
            }
        },
   }
```

ç›®å‰å·²ç»å®ç°äº†åŸºæœ¬éœ€æ±‚ï¼Œæ ·å¼ä¸Šæœ‰ç‚¹å°ç‘•ç–µï¼Œå› ä¸ºæˆ‘ä»¬æ”¹å˜æ˜¯æ–‡ä»¶åˆ—è¡¨ï¼Œå·²ç»é€‰æ‹©è¿‡æ–‡ä»¶ï¼Œå†æ¬¡é€‰æ‹©æ–‡ä»¶ä¹‹åï¼Œä»ç¬¬ä¸€ä¸ªæ–‡ä»¶åˆ°ç¬¬äºŒä¸ªæ–‡ä»¶ï¼Œæœ‰åŠ¨æ€åˆ‡æ¢çš„æ•ˆæœï¼Œ è¿™ä¸ªç‰¹æ•ˆæˆ‘ä»¬ä¸éœ€è¦ã€‚åœ¨ elment çš„ upload æºç ä¸­ï¼Œæœ‰è¿™æ ·ä¸€ä¸ªåŠ¨ç”»ï¼š

```css
.el-list-enter-active,
.el-list-leave-active {
    -webkit-transition: all 1s;
    -o-transition: all 1s;
    transition: all 1s;
}
```

æˆ‘ä»¬è®¾ç½® transition ä¸º none å»æ‰è¿™ä¸€éƒ¨åˆ†åŠ¨ç”»å°±å¯ä»¥äº†ï¼Œ
å½“ style æ ‡ç­¾æœ‰ scoped å±æ€§æ—¶ï¼Œå®ƒçš„ CSS åªä½œç”¨äºå½“å‰ç»„ä»¶ä¸­çš„å…ƒç´ ,å¦‚æœä½ å¸Œæœ› scoped æ ·å¼ä¸­çš„ä¸€ä¸ªé€‰æ‹©å™¨èƒ½å¤Ÿä½œç”¨å¾—â€œæ›´æ·±â€ï¼Œå¯ä»¥ä½¿ç”¨æ·±åº¦ä½œç”¨é€‰æ‹©å™¨ >>> ï¼Œ ä½†å¦‚æœæ˜¯ sass/less çš„è¯å¯èƒ½æ— æ³•è¯†åˆ«ï¼Œè¿™æ—¶å€™éœ€è¦ä½¿ç”¨ /deep/ é€‰æ‹©å™¨ã€‚

```css
/deep/ .el-list-enter-active,
/deep/ .el-list-leave-active {
    transition: none;
}

/deep/ .el-list-enter,
/deep/ .el-list-leave-active {
    opacity: 0;
}
```
